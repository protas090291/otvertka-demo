# Как настроить смету в программе (простой гайд)

## Шаг 1. Создать таблицы в Supabase (один раз)

1. Откройте браузер и зайдите на сайт **Supabase**: https://supabase.com  
2. Войдите в свой аккаунт и откройте **ваш проект**.
3. В левом меню нажмите **SQL Editor** (Редактор SQL).
4. Нажмите **New query** (Новый запрос).
5. На своём компьютере откройте файл **supabase_estimate_tables.sql** (он лежит в папке Helper2).
6. Выделите в нём **весь текст** (Ctrl+A или Cmd+A) и **скопируйте** (Ctrl+C или Cmd+C).
7. Вернитесь в браузер, в окно запроса вставьте скопированный текст (Ctrl+V или Cmd+V).
8. Нажмите **Run** (Запустить) внизу справа.
9. Должно появиться сообщение, что запрос выполнен. Таблицы для сметы созданы.

**Если таблицы вы создавали раньше** (до появления колонки «Квартира»): выполните ещё один запрос из файла **supabase_estimate_add_apartment.sql** (добавит колонку «квартира» к позициям сметы).

**Если нужно удалить старые данные сметы и загрузить заново:** выполните в SQL Editor скрипт **supabase_estimate_clear_data.sql** — он удалит все позиции и все сметы. Таблицы останутся; при следующем открытии сметы в программе создастся новая пустая смета, и можно будет импортировать правильный файл (лист «Смета»).

---

## Шаг 2. Загрузить смету из вашего файла (Excel)

1. Откройте программу **Отвёртка** и войдите в систему.
2. В левом меню нажмите **Проекты**.
3. Найдите нужный проект и нажмите на нём кнопку **Смета** (синяя кнопка рядом с «Планы»).
4. На экране сметы нажмите кнопку **«Импорт из Excel/CSV»**.
5. Выберите ваш файл сметы (например, **smeta.xlsx**) на компьютере и откройте его.

**Как должен выглядеть файл:**
- Откройте ваш файл в Excel. Если в файле несколько листов (например, «Сводная» и «Смета») — программа **автоматически возьмёт лист с именем «Смета»**, а не первый. Если листа «Смета» нет, используется первый лист.
- Подходят варианты:
  - **Вариант А:** Столбец A — название, B — ед. изм., C — количество. В первой строке могут быть заголовки или сразу данные.
  - **Вариант Б:** A — № или пусто, B — название, C — ед. изм., D — количество.
  - **С квартирами:** если в таблице есть столбец «Квартира» / «Кв.» / «№ кв» — программа подхватит его и привяжет каждую строку к квартире. Либо: A — квартира, B — название, C — ед. изм., D — количество. Тогда по одной строке на каждую квартиру и каждую работу — в смете будет столько позиций, сколько строк в файле (например, 50 квартир × много работ).
- Импортируются **все подходящие строки** с первого листа; фильтр по квартире потом можно включить в интерфейсе сметы.

6. Программа добавит позиции в смету (без денег — только названия и объёмы).
7. Готово. Позиции появятся в таблице.

**Если пишет «В файле не найдено строк для импорта»:** откройте файл в Excel, проверьте, что на первом листе есть непустые ячейки: хотя бы столбцы с названием и количеством. Сохраните файл (Ctrl+S) и запустите импорт ещё раз. Если не получится — добавьте позиции вручную кнопкой «Добавить позицию».

---

## Шаг 3. Указывать ответственных и объёмы в работе

1. Остаётесь на том же экране сметы того же проекта.
2. В каждой строке есть иконка **человека** (Назначить). Нажмите её.
3. Выберите, **кто отвечает** (Прораб, Подрядчик, Рабочий и т.д.).
4. Введите **объём в работе** — сколько по этой позиции уже взял в работу или сделал этот человек.
5. Нажмите **Ок**. Данные сохранятся в базе.
6. При необходимости поменяйте **статус** в выпадающем списке: Не начато / В работе / Выполнено.

Дополнительно ничего загружать не нужно — всё хранится в Supabase и открывается в программе при следующем заходе.

---

## Если что-то не работает

- **«Не удалось загрузить или создать смету»** — значит таблицы в Supabase ещё не созданы. Сделайте заново Шаг 1.
- **Импорт Excel не срабатывает** — проверьте, что в папке Helper2 выполнена команда `npm install` (чтобы был установлен пакет xlsx). Для импорта CSV ничего дополнительно ставить не нужно.
- Файл сметы можно держать только на компьютере: один раз импортировали — дальше все изменения делаете в программе.
