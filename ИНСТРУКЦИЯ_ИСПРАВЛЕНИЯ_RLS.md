# Инструкция по исправлению проблемы с обновлением прогресса задач

## Проблема
При попытке обновить прогресс задач возникает ошибка, связанная с отсутствием RLS политик для таблицы `tasks`.

## Решение

### Шаг 1: Откройте Supabase Dashboard
1. Перейдите в [Supabase Dashboard](https://supabase.com/dashboard)
2. Выберите ваш проект
3. Перейдите в раздел "SQL Editor"

### Шаг 2: Выполните диагностику
Скопируйте и выполните содержимое файла `check_database_setup.sql` для проверки текущего состояния базы данных.

### Шаг 3: Исправьте RLS политики
Скопируйте и выполните содержимое файла `fix_tasks_rls.sql` для исправления RLS политик.

### Шаг 4: Если таблица tasks не существует
Если в результате диагностики выяснится, что таблица `tasks` не существует, выполните содержимое файла `create_tasks_table.sql`.

## Проверка результата

После выполнения скриптов:

1. **Проверьте политики RLS:**
```sql
SELECT policyname, cmd, permissive 
FROM pg_policies 
WHERE tablename = 'tasks';
```

2. **Проверьте структуру таблицы:**
```sql
SELECT column_name, data_type, is_nullable 
FROM information_schema.columns 
WHERE table_name = 'tasks';
```

3. **Проверьте работу приложения:**
   - Откройте приложение в браузере
   - Попробуйте изменить прогресс задачи
   - Проверьте консоль браузера на наличие ошибок

## Ожидаемый результат

После выполнения всех скриптов:
- Таблица `tasks` будет существовать
- RLS будет включен с правильными политиками
- Обновление прогресса задач будет работать корректно
- В консоли браузера не будет ошибок доступа к базе данных

## Дополнительная информация

Если проблемы остаются:
1. Проверьте правильность URL и ключей Supabase в файле `src/lib/supabase.ts`
2. Убедитесь, что используете service role key для админских операций
3. Проверьте логи Supabase в разделе "Logs" в Dashboard
